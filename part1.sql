
DROP DATABASE IF EXISTS Lab2_19001395_DW_V;
CREATE DATABASE Lab2_19001395_DW_V;

USE Lab2_19001395_DW_V;

CREATE TABLE departamentos(
    codigo_departamento INT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);

CREATE TABLE cursos(
    id INT PRIMARY KEY,
    codigo VARCHAR(5) NOT NULL,
    nombre VARCHAR(25) NOT NULL,
    descripcion TEXT,
    codigo_departamento INT NULL,
    CONSTRAINT UC_curso_codigo UNIQUE(codigo),
    CONSTRAINT formato_curso_codigo CHECK (codigo REGEXP '^[A-Z0-9]{2}-[0-9]{2}$'),
    FOREIGN KEY (codigo_departamento)
        REFERENCES departamentos(codigo_departamento)
        ON DELETE SET NULL
        ON UPDATE CASCADE
);

CREATE TABLE libros(
    isbn VARCHAR(13) PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL,
    autor VARCHAR(30) NOT NULL,
    anio int NOT NULL,
    edicion INT NOT NULL,
    editorial VARCHAR(40) NOT NULL,
    codigo_curso VARCHAR(5) NOT NULL,
    CONSTRAINT isbn_formato_inicial CHECK (
        SUBSTRING(isbn, 1, 2) NOT IN ('00', '01')
    ),
    CONSTRAINT isbn_formato_numeros CHECK(
        isbn REGEXP '^[0-9]{13}$'
    ),
    CONSTRAINT edicion_check_range CHECK (
        edicion > 3 AND edicion < 7
    ),
    FOREIGN KEY (codigo_curso)
        REFERENCES cursos(codigo)
        ON DELETE CASCADE
);


INSERT INTO departamentos (codigo_departamento, nombre) VALUES
(1, 'Departamento 1'),
(2, 'Departamento 2'),
(3, 'Departamento 3'),
(4, 'Departamento 4'),
(5, 'Departamento 5');

INSERT INTO cursos (id, codigo, nombre, descripcion, codigo_departamento) VALUES
(1, 'AB-01', 'Curso 1', 'Descripción del curso 1', 1),
(2, 'CD-02', 'Curso 2', 'Descripción del curso 2', 2),
(3, 'EF-03', 'Curso 3', 'Descripción del curso 3', 3),
(4, 'GH-04', 'Curso 4', 'Descripción del curso 4', 4),
(5, 'IJ-05', 'Curso 5', 'Descripción del curso 5', 5),
(6, 'KL-06', 'Curso 6', 'Descripción del curso 6', 1),
(7, 'MN-07', 'Curso 7', 'Descripción del curso 7', 2),
(8, 'OP-08', 'Curso 8', 'Descripción del curso 8', 3),
(9, 'QR-09', 'Curso 9', 'Descripción del curso 9', 4),
(10, 'ST-10', 'Curso 10', 'Descripción del curso 10', 5),
(11, 'UV-11', 'Curso 11', 'Descripción del curso 11', 1),
(12, 'WX-12', 'Curso 12', 'Descripción del curso 12', 2),
(13, 'YZ-13', 'Curso 13', 'Descripción del curso 13', 3),
(14, 'AB-14', 'Curso 14', 'Descripción del curso 14', 4),
(15, 'CD-15', 'Curso 15', 'Descripción del curso 15', 5),
(16, 'EF-16', 'Curso 16', 'Descripción del curso 16', 1),
(17, 'GH-17', 'Curso 17', 'Descripción del curso 17', 2),
(18, 'IJ-18', 'Curso 18', 'Descripción del curso 18', 3),
(19, 'KL-19', 'Curso 19', 'Descripción del curso 19', 4),
(20, 'MN-20', 'Curso 20', 'Descripción del curso 20', 5),
(21, 'OP-21', 'Curso 21', 'Descripción del curso 21', 1),
(22, 'QR-22', 'Curso 22', 'Descripción del curso 22', 2),
(23, 'ST-23', 'Curso 23', 'Descripción del curso 23', 3),
(24, 'UV-24', 'Curso 24', 'Descripción del curso 24', 4),
(25, 'WX-25', 'Curso 25', 'Descripción del curso 25', 5),
(26, 'YZ-26', 'Curso 26', 'Descripción del curso 26', 1),
(27, 'AB-27', 'Curso 27', 'Descripción del curso 27', 2),
(28, 'CD-28', 'Curso 28', 'Descripción del curso 28', 3),
(29, 'EF-29', 'Curso 29', 'Descripción del curso 29', 4),
(30, 'GH-30', 'Curso 30', 'Descripción del curso 30', 5),
(31, 'IJ-31', 'Curso 31', 'Descripción del curso 31', 1),
(32, 'KL-32', 'Curso 32', 'Descripción del curso 32', 2),
(33, 'MN-33', 'Curso 33', 'Descripción del curso 33', 3),
(34, 'OP-34', 'Curso 34', 'Descripción del curso 34', 4),
(35, 'QR-35', 'Curso 35', 'Descripción del curso 35', 5),
(36, 'ST-36', 'Curso 36', 'Descripción del curso 36', 1),
(37, 'UV-37', 'Curso 37', 'Descripción del curso 37', 2),
(38, 'WX-38', 'Curso 38', 'Descripción del curso 38', 3),
(39, 'YZ-39', 'Curso 39', 'Descripción del curso 39', 4),
(40, 'AB-40', 'Curso 40', 'Descripción del curso 40', 5),
(41, 'CD-41', 'Curso 41', 'Descripción del curso 41', 1),
(42, 'EF-42', 'Curso 42', 'Descripción del curso 42', 2),
(43, 'GH-43', 'Curso 43', 'Descripción del curso 43', 3),
(44, 'IJ-44', 'Curso 44', 'Descripción del curso 44', 4),
(45, 'KL-45', 'Curso 45', 'Descripción del curso 45', 5),
(46, 'MN-46', 'Curso 46', 'Descripción del curso 46', 1),
(47, 'OP-47', 'Curso 47', 'Descripción del curso 47', 2);


INSERT INTO libros (isbn, nombre, autor, edicion, anio,editorial, codigo_curso) VALUES
('9780141439601', 'Libro 1', 'Autor 1', 4, 2012,'Editorial 1', 'AB-01'),
('9780451524935', 'Libro 2', 'Autor 2', 5, 2012,'Editorial 2', 'CD-02'),
('9780743273565', 'Libro 3', 'Autor 3', 6, 2012,'Editorial 3', 'EF-03'),
('9780670033840', 'Libro 4', 'Autor 4', 4, 2012,'Editorial 4', 'GH-04'),
('9780307594002', 'Libro 5', 'Autor 5', 5, 2012,'Editorial 5', 'IJ-05'),
('9780739352352', 'Libro 6', 'Autor 6', 6, 2012,'Editorial 6', 'AB-01'),
('9780307743652', 'Libro 7', 'Autor 7', 4, 2012,'Editorial 7', 'CD-02'),
('9780143115270', 'Libro 8', 'Autor 8', 5, 2012,'Editorial 8', 'EF-03'),
('9780307594032', 'Libro 9', 'Autor 9', 6, 2012,'Editorial 9', 'GH-04'),
('9780307594566', 'Libro 10', 'Autor 10', 4, 2014, 'Editorial 10', 'IJ-05'),
('9780451524955', 'Libro 11', 'Autor 11', 5, 2014, 'Editorial 11', 'AB-01'),
('9780451524941', 'Libro 12', 'Autor 12', 6, 2014, 'Editorial 12', 'CD-02'),
('9780141439602', 'Libro 13', 'Autor 13', 4, 2014, 'Editorial 13', 'EF-03'),
('9780307743653', 'Libro 14', 'Autor 14', 5, 2014, 'Editorial 14', 'GH-04'),
('9780739352353', 'Libro 15', 'Autor 15', 6, 2014, 'Editorial 15', 'IJ-05'),
('9780143115271', 'Libro 16', 'Autor 16', 4, 2014, 'Editorial 16', 'AB-01'),
('9780307594033', 'Libro 17', 'Autor 17', 5, 2014, 'Editorial 17', 'CD-02'),
('9780451524936', 'Libro 18', 'Autor 18', 6, 2014, 'Editorial 18', 'EF-03'),
('9780451534942', 'Libro 19', 'Autor 19', 4, 2014, 'Editorial 19', 'GH-04'),
('9780307594567', 'Libro 20', 'Autor 20', 5, 2014, 'Editorial 20', 'IJ-05'),
('9780141439620', 'Libro 21', 'Autor 21', 6, 2014, 'Editorial 21', 'AB-01'),
('9780307743654', 'Libro 22', 'Autor 22', 4, 2014, 'Editorial 22', 'CD-02'),
('9780739352351', 'Libro 23', 'Autor 23', 5, 2014, 'Editorial 23', 'EF-03'),
('9780143115272', 'Libro 24', 'Autor 24', 6, 2014, 'Editorial 24', 'GH-04'),
('9780307594000', 'Libro 25', 'Autor 25', 4, 2014, 'Editorial 25', 'IJ-05'),
('9780451524937', 'Libro 26', 'Autor 26', 5, 2014, 'Editorial 26', 'AB-01'),
('9780451524943', 'Libro 27', 'Autor 27', 6, 2014, 'Editorial 27', 'CD-02'),
('9780307594568', 'Libro 28', 'Autor 28', 4, 2014, 'Editorial 28', 'EF-03'),
('9780307743655', 'Libro 29', 'Autor 29', 5, 2014, 'Editorial 29', 'GH-04'),
('9780739352354', 'Libro 30', 'Autor 30', 6, 2018, 'Editorial 30', 'IJ-05'),
('9780143115273', 'Libro 31', 'Autor 31', 4, 2018, 'Editorial 31', 'AB-01'),
('9780307594010', 'Libro 32', 'Autor 32', 5, 2018, 'Editorial 32', 'CD-02'),
('9780451524938', 'Libro 33', 'Autor 33', 6, 2018, 'Editorial 33', 'EF-03'),
('9780451524944', 'Libro 34', 'Autor 34', 4, 2018, 'Editorial 34', 'GH-04'),
('9780307594569', 'Libro 35', 'Autor 35', 5, 2018, 'Editorial 35', 'IJ-05'),
('9780141439603', 'Libro 36', 'Autor 36', 6, 2018, 'Editorial 36', 'AB-01'),
('9780307743656', 'Libro 37', 'Autor 37', 4, 2018, 'Editorial 37', 'CD-02'),
('9780739352355', 'Libro 38', 'Autor 38', 5, 2018, 'Editorial 38', 'EF-03'),
('9780143115274', 'Libro 39', 'Autor 39', 6, 2018, 'Editorial 39', 'GH-04'),
('9780307594005', 'Libro 40', 'Autor 40', 4, 2018, 'Editorial 40', 'IJ-05'),
('9780451524939', 'Libro 41', 'Autor 41', 5, 2018, 'Editorial 41', 'AB-01'),
('9780451524945', 'Libro 42', 'Autor 42', 6, 2018, 'Editorial 42', 'CD-02'),
('9780307594570', 'Libro 43', 'Autor 43', 4, 2018, 'Editorial 43', 'EF-03'),
('9780307743659', 'Libro 44', 'Autor 44', 5, 2018, 'Editorial 44', 'GH-04'),
('9780739352356', 'Libro 45', 'Autor 45', 6, 2018, 'Editorial 45', 'IJ-05'),
('9780143115275', 'Libro 46', 'Autor 46', 4, 2018, 'Editorial 46', 'AB-01'),
('9780307594110', 'Libro 47', 'Autor 47', 5, 2018, 'Editorial 47', 'CD-02'),
('9780451524940', 'Libro 48', 'Autor 48', 6, 2018, 'Editorial 48', 'EF-03'),
('9780451524946', 'Libro 49', 'Autor 49', 4, 2018, 'Editorial 49', 'GH-04'),
('9780307594571', 'Libro 50', 'Autor 50', 5, 2018, 'Editorial 50', 'IJ-05'),
('9780141439604', 'Libro 51', 'Autor 51', 6, 2018, 'Editorial 51', 'AB-01'),
('9780307743658', 'Libro 52', 'Autor 52', 4, 2018, 'Editorial 52', 'CD-02'),
('9780739352357', 'Libro 53', 'Autor 53', 5, 2018, 'Editorial 53', 'EF-03'),
('9780143115276', 'Libro 54', 'Autor 54', 6, 2018, 'Editorial 54', 'GH-04'),
('9780307594102', 'Libro 55', 'Autor 55', 4, 2018, 'Editorial 55', 'IJ-05'),
('9780451525941', 'Libro 56', 'Autor 56', 5, 2018, 'Editorial 56', 'AB-01'),
('9780451524947', 'Libro 57', 'Autor 57', 6, 2018, 'Editorial 57', 'CD-02'),
('9780307594572', 'Libro 58', 'Autor 58', 4, 2018, 'Editorial 58', 'EF-03'),
('9780307743668', 'Libro 59', 'Autor 59', 5, 2019, 'Editorial 59', 'GH-04'),
('9780739352358', 'Libro 60', 'Autor 60', 6, 2019, 'Editorial 60', 'IJ-05'),
('9780141439605', 'Libro 61', 'Autor 61', 4, 2019, 'Editorial 61', 'AB-01'),
('9780307594103', 'Libro 62', 'Autor 62', 5, 2019, 'Editorial 62', 'CD-02'),
('9780451524942', 'Libro 63', 'Autor 63', 6, 2019, 'Editorial 63', 'EF-03'),
('9780451524948', 'Libro 64', 'Autor 64', 4, 2019, 'Editorial 64', 'GH-04'),
('9780307594573', 'Libro 65', 'Autor 65', 5, 2019, 'Editorial 65', 'IJ-05'),
('9780141439606', 'Libro 66', 'Autor 66', 6, 2019, 'Editorial 66', 'AB-01'),
('9780307743660', 'Libro 67', 'Autor 67', 4, 2019, 'Editorial 67', 'CD-02'),
('9780739352359', 'Libro 68', 'Autor 68', 5, 2019, 'Editorial 68', 'EF-03'),
('9780143115277', 'Libro 69', 'Autor 69', 6, 2019, 'Editorial 69', 'GH-04'),
('9780307594104', 'Libro 70', 'Autor 70', 4, 2019, 'Editorial 70', 'IJ-05'),
('9780455524943', 'Libro 71', 'Autor 71', 5, 2019, 'Editorial 71', 'AB-01'),
('9780307594574', 'Libro 72', 'Autor 72', 6, 2019, 'Editorial 72', 'CD-02'),
('9780307743661', 'Libro 73', 'Autor 73', 4, 2019, 'Editorial 73', 'EF-03'),
('9780739352360', 'Libro 74', 'Autor 74', 5, 2019, 'Editorial 74', 'GH-04'),
('9780143115278', 'Libro 75', 'Autor 75', 6, 2019, 'Editorial 75', 'IJ-05'),
('9780307594105', 'Libro 76', 'Autor 76', 4, 2019, 'Editorial 76', 'AB-01'),
('9780451524844', 'Libro 77', 'Autor 77', 5, 2019, 'Editorial 77', 'CD-02'),
('9780451524999', 'Libro 78', 'Autor 78', 6, 2019, 'Editorial 78', 'EF-03'),
('9780307594575', 'Libro 79', 'Autor 79', 4, 2019, 'Editorial 79', 'GH-04'),
('9780307743662', 'Libro 80', 'Autor 80', 5, 2019, 'Editorial 80', 'IJ-05'),
('9780739352361', 'Libro 81', 'Autor 81', 6, 2019, 'Editorial 81', 'AB-01'),
('9780143115279', 'Libro 82', 'Autor 82', 4, 2019, 'Editorial 82', 'CD-02'),
('9780307594106', 'Libro 83', 'Autor 83', 5, 2019, 'Editorial 83', 'EF-03'),
('9780455524945', 'Libro 84', 'Autor 84', 6, 2019, 'Editorial 84', 'GH-04'),
('9780451524950', 'Libro 85', 'Autor 85', 4, 2019, 'Editorial 85', 'IJ-05'),
('9780307594576', 'Libro 86', 'Autor 86', 5, 2019, 'Editorial 86', 'AB-01'),
('9780307743663', 'Libro 87', 'Autor 87', 6, 2020, 'Editorial 87', 'CD-02'),
('9780739352362', 'Libro 88', 'Autor 88', 4, 2020, 'Editorial 88', 'EF-03'),
('9780143115280', 'Libro 89', 'Autor 89', 5, 2020, 'Editorial 89', 'GH-04'),
('9780307594107', 'Libro 90', 'Autor 90', 6, 2020, 'Editorial 90', 'IJ-05'),
('9780451524996', 'Libro 91', 'Autor 91', 4, 2020, 'Editorial 91', 'AB-01'),
('9780451524951', 'Libro 92', 'Autor 92', 5, 2020, 'Editorial 92', 'CD-02'),
('9780307594577', 'Libro 93', 'Autor 93', 6, 2020, 'Editorial 93', 'EF-03'),
('9780307743664', 'Libro 94', 'Autor 94', 4, 2020, 'Editorial 94', 'GH-04'),
('9780739352363', 'Libro 95', 'Autor 95', 5, 2020, 'Editorial 95', 'IJ-05'),
('9780143115281', 'Libro 96', 'Autor 96', 6, 2020, 'Editorial 96', 'AB-01'),
('9780307594108', 'Libro 97', 'Autor 97', 4, 2020, 'Editorial 97', 'CD-02'),
('9780451524997', 'Libro 98', 'Autor 98', 5, 2020, 'Editorial 98', 'EF-03'),
('9780451524952', 'Libro 99', 'Autor 99', 6, 2020, 'Editorial 99', 'GH-04'),
('9780307594578', 'Libro 100', 'Autor 100', 4, 2018, 'Editorial 100', 'IJ-05'),
('9780141439607', 'Libro 101', 'Autor 101', 5, 2018, 'Editorial 101', 'AB-01'),
('9780307743665', 'Libro 102', 'Autor 102', 6, 2018, 'Editorial 102', 'CD-02'),
('9780143115282', 'Libro 103', 'Autor 103', 4, 2018, 'Editorial 103', 'EF-03'),
('9780307594109', 'Libro 104', 'Autor 104', 5, 2018, 'Editorial 104', 'GH-04'),
('9780451524998', 'Libro 105', 'Autor 105', 6, 2018, 'Editorial 105', 'IJ-05'),
('9780451524953', 'Libro 106', 'Autor 106', 4, 2018, 'Editorial 106', 'AB-01'),
('9780307594579', 'Libro 107', 'Autor 107', 5, 2018, 'Editorial 107', 'CD-02'),
('9780307743666', 'Libro 108', 'Autor 108', 6, 2018, 'Editorial 108', 'EF-03'),
('9780739352364', 'Libro 109', 'Autor 109', 4, 2018, 'Editorial 109', 'GH-04'),
('9780143115283', 'Libro 110', 'Autor 110', 5, 2018, 'Editorial 110', 'IJ-05'),
('9780307594210', 'Libro 111', 'Autor 111', 6, 2018, 'Editorial 111', 'AB-01'),
('9780451524949', 'Libro 112', 'Autor 112', 4, 2018, 'Editorial 112', 'CD-02'),
('9780451524954', 'Libro 113', 'Autor 113', 5, 2018, 'Editorial 113', 'EF-03'),
('9780307594580', 'Libro 114', 'Autor 114', 6, 2018, 'Editorial 114', 'GH-04'),
('9780307743667', 'Libro 115', 'Autor 115', 4, 2018, 'Editorial 115', 'IJ-05'),
('9780739352365', 'Libro 116', 'Autor 116', 5, 2018, 'Editorial 116', 'AB-01'),
('9780143115284', 'Libro 117', 'Autor 117', 6, 2018, 'Editorial 117', 'CD-02'),
('9780307594111', 'Libro 118', 'Autor 118', 4, 2019, 'Editorial 118', 'EF-03'),
('9780451524990', 'Libro 119', 'Autor 119', 5, 2019, 'Editorial 119', 'GH-04'),
('9780451524985', 'Libro 120', 'Autor 120', 6, 2019, 'Editorial 120', 'IJ-05'),
('9780307594581', 'Libro 121', 'Autor 121', 4, 2019, 'Editorial 121', 'AB-01'),
('9780307743768', 'Libro 122', 'Autor 122', 5, 2019, 'Editorial 122', 'CD-02'),
('9780739352366', 'Libro 123', 'Autor 123', 6, 2019, 'Editorial 123', 'EF-03'),
('9780143115285', 'Libro 124', 'Autor 124', 4, 2019, 'Editorial 124', 'GH-04'),
('9780307594112', 'Libro 125', 'Autor 125', 5, 2019, 'Editorial 125', 'IJ-05'),
('9780451524918', 'Libro 126', 'Autor 126', 6, 2019, 'Editorial 126', 'AB-01'),
('9780451524956', 'Libro 127', 'Autor 127', 4, 2019, 'Editorial 127', 'CD-02'),
('9780307594582', 'Libro 128', 'Autor 128', 5, 2019, 'Editorial 128', 'EF-03'),
('9780307743669', 'Libro 129', 'Autor 129', 6, 2019, 'Editorial 129', 'GH-04'),
('9780739352367', 'Libro 130', 'Autor 130', 4, 2019, 'Editorial 130', 'IJ-05'),
('9780143115286', 'Libro 131', 'Autor 131', 5, 2019, 'Editorial 131', 'AB-01'),
('9780307594100', 'Libro 132', 'Autor 132', 6, 2019, 'Editorial 132', 'CD-02'),
('9780451529952', 'Libro 133', 'Autor 133', 4, 2019, 'Editorial 133', 'EF-03'),
('9780451524957', 'Libro 134', 'Autor 134', 5, 2019, 'Editorial 134', 'GH-04'),
('9780307594583', 'Libro 135', 'Autor 135', 6, 2019, 'Editorial 135', 'IJ-05'),
('9780739352368', 'Libro 137', 'Autor 137', 5, 2019, 'Editorial 137', 'AB-01'),
('9780143115287', 'Libro 138', 'Autor 138', 6, 2019, 'Editorial 138', 'CD-02'),
('9780307594101', 'Libro 139', 'Autor 139', 4, 2019, 'Editorial 139', 'EF-03'),
('9780451529953', 'Libro 140', 'Autor 140', 5, 2019, 'Editorial 140', 'GH-04'),
('9780451524958', 'Libro 141', 'Autor 141', 6, 2019, 'Editorial 141', 'IJ-05'),
('9780307594584', 'Libro 142', 'Autor 142', 4, 2019, 'Editorial 142', 'AB-01'),
('9780307743670', 'Libro 143', 'Autor 143', 5, 2019, 'Editorial 143', 'CD-02'),
('9780739352369', 'Libro 144', 'Autor 144', 6, 2019, 'Editorial 144', 'EF-03'),
('9780143115288', 'Libro 145', 'Autor 145', 4, 2019, 'Editorial 145', 'GH-04'),
('9780307594020', 'Libro 146', 'Autor 146', 5, 2019, 'Editorial 146', 'IJ-05'),
('9780451529954', 'Libro 147', 'Autor 147', 6, 2019, 'Editorial 147', 'AB-01'),
('9780451524959', 'Libro 148', 'Autor 148', 4, 2019, 'Editorial 148', 'CD-02'),
('9780307594585', 'Libro 149', 'Autor 149', 5, 2019, 'Editorial 149', 'EF-03'),
('9780307743671', 'Libro 150', 'Autor 150', 6, 2019, 'Editorial 150', 'GH-04');
